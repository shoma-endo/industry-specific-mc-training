# GrowMate - AIãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ”¯æ´ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 

LINE LIFF ã‚’å…¥ã‚Šå£ã«ã€æ¥­ç•Œç‰¹åŒ–ã®ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ä¸€æ‹¬ç”Ÿæˆãƒ»ç®¡ç†ã™ã‚‹ SaaS ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚Next.js 15 App Router ã‚’åŸºç›¤ã«ã€ãƒãƒ«ãƒãƒ™ãƒ³ãƒ€ãƒ¼ AIã€WordPress é€£æºã€Stripe ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã€Supabase ã«ã‚ˆã‚‹å …ç‰¢ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚’çµ±åˆã—ã¦ã„ã¾ã™ã€‚

## ğŸ§­ ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆæ¦‚è¦
- LIFF ã§ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã«ã€åºƒå‘Šï¼LPï¼ãƒ–ãƒ­ã‚°åˆ¶ä½œã‚’æ”¯æ´ã™ã‚‹ AI ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‚’æä¾›
- Anthropic Claude Sonnet 4.5 ã¨ OpenAI ã® Fine-tuned ãƒ¢ãƒ‡ãƒ« `ft:gpt-4.1-nano-2025-04-14:personal::BZeCVPK2` ã‚’ç”¨é€”ã«å¿œã˜ã¦åˆ‡ã‚Šæ›¿ãˆ
- WordPress.com / è‡ªç¤¾ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã‚’å•ã‚ãªã„æŠ•ç¨¿å–å¾—ã¨ã€Supabase ã¸ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ³¨é‡ˆä¿å­˜
- Stripe ã‚’ç”¨ã„ãŸæœ‰æ–™ãƒ—ãƒ©ãƒ³ç®¡ç†ã¨ã€ãƒ­ãƒ¼ãƒ«ï¼ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é€£å‹•ã«ã‚ˆã‚‹æ©Ÿèƒ½åˆ¶å¾¡
- ç®¡ç†è€…å‘ã‘ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ç®¡ç† UI ã‚’å†…è”µ

## ğŸš€ ä¸»ãªæ©Ÿèƒ½

### LINE LIFF èªè¨¼ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
- LIFF v2.25 ã‚’åˆ©ç”¨ã—ãŸã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãª LINE ãƒ­ã‚°ã‚¤ãƒ³ã¨è‡ªå‹•ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥
- ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã® `authMiddleware` ã§ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ãƒ»ãƒ­ãƒ¼ãƒ«åˆ¤å®šã‚’ä¸€å…ƒç®¡ç†
- Supabase `users` ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ»ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ IDãƒ»ãƒ­ãƒ¼ãƒ«ãƒ»æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³ã‚’ä¿å­˜

### AI ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ”¯æ´ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹
- `app/chat` é…ä¸‹ã® ChatLayout ã§ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ãƒ»ãƒ¢ãƒ‡ãƒ«é¸æŠãƒ»AI å¿œç­”ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚’çµ±åˆ
- `MODEL_CONFIGS` ã«å®šç¾©ã—ãŸ 7 ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ–ãƒ­ã‚°ä½œæˆãƒ•ãƒ­ãƒ¼ï¼ˆãƒ‹ãƒ¼ã‚ºæ•´ç†ã€œæœ¬æ–‡ä½œæˆï¼‰ã¨åºƒå‘Šï¼LP ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æä¾›
- `POST /api/chat/anthropic/stream` ã«ã‚ˆã‚‹ SSE ã§ Claude å¿œç­”ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»
- ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«æ¤œç´¢ãƒãƒ¼ã‚’è¿½åŠ ã—ã€`search_chat_sessions` RPCï¼ˆå…¨æ–‡æ¤œç´¢ + `pg_trgm` é¡ä¼¼æ¤œç´¢ï¼‰ã§ã‚¿ã‚¤ãƒˆãƒ«ã‚„æ­£è¦åŒ–æ¸ˆã¿ WordPress URL ã‚’æ¨ªæ–­æ¤œç´¢
- ã‚¹ãƒ†ãƒƒãƒ—æ¯ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå¤‰æ•°ã¸ `content_annotations` ã¨ äº‹æ¥­è€…ãƒ–ãƒªãƒ¼ãƒ• (`briefs`) ã‚’ãƒãƒ¼ã‚¸ã—ã€æ–‡è„ˆã®å†åˆ©ç”¨ã‚’æœ€å°åŒ–

### ã‚­ãƒ£ãƒ³ãƒã‚¹ç·¨é›†ã¨é¸æŠç¯„å›²ãƒªãƒ©ã‚¤ãƒˆ
- TipTap 3 ãƒ™ãƒ¼ã‚¹ã® `CanvasPanel` ã« Markdown ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼è¦‹å‡ºã—ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ï¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã‚’å®Ÿè£…
- `POST /api/chat/canvas/stream` ã§é¸æŠç¯„å›²ã¨æŒ‡ç¤ºã‚’é€ä¿¡ã—ã€Claude ã® Tool Use ã«ã‚ˆã‚‹å…¨æ–‡å·®ã—æ›¿ãˆã‚’é©ç”¨
- é¸æŠãƒ†ã‚­ã‚¹ãƒˆã®å±¥æ­´ãƒ»ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»Web æ¤œç´¢ãƒˆãƒªã‚¬ãƒ¼ï¼ˆClaude ãƒ„ãƒ¼ãƒ« `web_search_20250305`ï¼‰ã‚’ã‚µãƒãƒ¼ãƒˆ

### WordPress é€£æºã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„æ³¨é‡ˆ
- WordPress.com OAuth ã¨ã‚»ãƒ«ãƒ•ãƒ›ã‚¹ãƒˆç‰ˆ Application Password ã®ä¸¡å¯¾å¿œï¼ˆ`app/setup/wordpress`ï¼‰
- `WordPressService` ãŒ REST API ã®å€™è£œ URL ã‚’è©¦è¡Œã—ã€æŠ•ç¨¿æƒ…å ±ã‚’æ­£è¦åŒ–
- `app/analytics` ã®ä¸€è¦§ã§æŠ•ç¨¿ã¨ Supabase `content_annotations` ã‚’çªãåˆã‚ã›ã€æœªç´ä»˜ã‘ã®æ³¨é‡ˆã‚‚è¡¨ç¤º
- `AnnotationPanel` ã§ã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã®ãƒ¡ãƒ¢ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ»ãƒšãƒ«ã‚½ãƒŠãƒ»PREP ç­‰ã‚’ä¿å­˜ã—ã€ãƒ–ãƒ­ã‚°ç”Ÿæˆæ™‚ã«å†åˆ©ç”¨

### Google Search Console é€£æº
- `/setup/gsc` ã§ OAuth èªè¨¼çŠ¶æ…‹ãƒ»æ¥ç¶šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å¯è¦–åŒ–ã—ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é¸æŠã‚„é€£æºè§£é™¤ã‚’å®Ÿè¡Œ
- `app/api/gsc/oauth/*` ãŒ Google OAuth 2.0 ã®é–‹å§‹ï¼ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã«å¯¾å¿œã—ã€Supabase `gsc_credentials` ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
- GSCé€£æºï¼ˆçŠ¶æ…‹ç¢ºèªãƒ»ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å–å¾—ãƒ»é¸æŠæ›´æ–°ãƒ»æ¥ç¶šè§£é™¤ï¼‰ã¯ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³çµŒç”±ã§å‡¦ç†ï¼ˆ`src/components/GscSetupActions.ts` / `src/server/actions/gscDashboard.actions.ts` ãªã©ï¼‰
- Search Console æ—¥æ¬¡æŒ‡æ¨™ã¯ `gsc_page_metrics`ã€ã‚¯ã‚¨ãƒªæŒ‡æ¨™ã¯ `gsc_query_metrics` ã«ä¿å­˜ã—ã€WordPress æ³¨é‡ˆ (`content_annotations`) ã¨ 1:N ã§ç´ä»˜ã‘å¯èƒ½ï¼ˆnormalized_url ã§ãƒãƒƒãƒãƒ³ã‚°ï¼‰ã€‚
- GSC ã‚¤ãƒ³ãƒãƒ¼ãƒˆã¯ 30 æ—¥å˜ä½ã§è‡ªå‹•åˆ†å‰²ã—ã€ã‚¯ã‚¨ãƒªæŒ‡æ¨™ã¯ 1,000 è¡Œ Ã— 10 ãƒšãƒ¼ã‚¸ = æœ€å¤§ 10,000 è¡Œã‚’ä¸Šé™ã¨ã—ã¦å–å¾—ã€‚
- è¨˜äº‹ã”ã¨ã®é †ä½è©•ä¾¡ã¨æ”¹å–„ææ¡ˆã‚¹ãƒ†ãƒƒãƒ—ã‚’ `gsc_article_evaluations` / `gsc_article_evaluation_history` ã§ç®¡ç†ã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ30æ—¥é–“éš”ã§ã€Œã‚¿ã‚¤ãƒˆãƒ«â†’æ›¸ãå‡ºã—â†’æœ¬æ–‡â†’ãƒšãƒ«ã‚½ãƒŠã€ã®é †ã«ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚æ”¹å–„ãŒç¢ºèªã§ããŸã‚‰ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ãƒªã‚»ãƒƒãƒˆã€‚
- è©•ä¾¡é–“éš”ã¯ç’°å¢ƒå¤‰æ•° `GSC_EVALUATION_INTERVAL_DAYS` ã§ä¸€æ‹¬è¨­å®šï¼ˆæœªè¨­å®šæ™‚ã¯30æ—¥ï¼‰ã€‚å°†æ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥è¨­å®šæ‹¡å¼µã‚’è¦‹è¾¼ã‚“ã§ã‚µãƒ¼ãƒãƒ¼å´ã§å–å¾—é–¢æ•°ã‚’ç”¨æ„ã€‚

### ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¨æ¨©é™
- Stripe v17.7 ã§ Checkout / Billing Portal / Subscription çŠ¶æ…‹ç¢ºèªã‚’å®Ÿè£…ï¼ˆ`SubscriptionService`ï¼‰
- `SubscriptionService` ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ `useSubscriptionStatus` ã§ UI å´ã‹ã‚‰æœ‰åŠ¹ãƒ—ãƒ©ãƒ³ã‚’åˆ¤å®š
- `authMiddleware` ãŒ `requiresSubscription` ã‚’è¿”ã—ã€æœ‰æ–™æ©Ÿèƒ½ã¸ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’é©ç”¨
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ï¼ˆ`trial` / `paid` / `admin` / `unavailable`ï¼‰ã‚’ Supabase å´ã§ç®¡ç†ã—ã€LIFF ãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«è‡ªå‹•åŒæœŸï¼ˆ`trial` ã¯ãƒãƒ£ãƒƒãƒˆé€ä¿¡ãŒ1æ—¥3å›ã¾ã§ã€`paid` ã¯ç„¡åˆ¶é™ï¼‰

### ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
- `/admin` ã§ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®ç®¡ç† UI ã‚’æä¾›
- `/admin/prompts` ã‹ã‚‰ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç·¨é›†ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¿å­˜ã€æš—é»™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆcontent ç³»å¤‰æ•°ï¼‰èª¬æ˜ã‚’è¡¨ç¤º
- `/admin/users` ã§ã¯ãƒ­ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆå¾Œã« `POST /api/auth/clear-cache` ã‚’å‘¼ã³å‡ºã—ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å³æ™‚ç„¡åŠ¹åŒ–

### äº‹æ¥­è€…æƒ…å ±ãƒ–ãƒªãƒ¼ãƒ•
- `/business-info` ã§ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦ã‚„ 5W2Hã€æ±ºæ¸ˆæ–¹æ³•ãªã©ã‚’å…¥åŠ›ã—ã€`briefs` ãƒ†ãƒ¼ãƒ–ãƒ«ã« JSON ã¨ã—ã¦ä¿å­˜
- ãƒ–ãƒªãƒ¼ãƒ•ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®å¤‰æ•°ã¸æµç”¨ã•ã‚Œã€åºƒå‘Šæ–‡ã‚„ LP ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•è£œå®Œ

### ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å°ç·š
- `/setup/wordpress` ã§ WordPress é€£æºã®åˆæœŸè¨­å®šã‚’æ¡ˆå†…
- `/setup/gsc` ã§ Google Search Console OAuth é€£æºã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é¸æŠã‚’ç®¡ç†
- `/subscription` ã§ãƒ—ãƒ©ãƒ³è³¼å…¥ã€`/analytics` ã§ WordPress æŠ•ç¨¿ã¨æ³¨é‡ˆã‚’ç…§åˆ

## ğŸ—ï¸ ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```mermaid
graph TB
  subgraph Client["Next.js 15 (App Router)"]
    LIFFProvider["LIFF Provider & Auth Hooks"]
    ChatUI["Chat Layout / Session Sidebar"]
    Canvas["CanvasPanel (TipTap)"]
    Annotation["AnnotationPanel"]
    Analytics["Analytics Table"]
    BusinessForm["Business Info Form"]
    AdminUI["Admin Dashboards"]
    GscSetup["GSC Setup Dashboard"]
    GscDashboard["GSC Analytics Dashboard"]
  end

  subgraph Server["Next.js Route Handlers & Server Actions"]
    AuthMiddleware["authMiddleware"]
    ChatStream["/api/chat/anthropic/stream"]
    CanvasStream["/api/chat/canvas/stream"]
    WordPressAPI["/api/wordpress/*"]
    AdminAPI["/api/admin/*"]
    SubscriptionAPI["/api/refresh, /api/user/*"]
    GscAPI["/api/gsc/*"]
    GscCron["/api/cron/gsc-evaluate"]
    ServerActions["server/actions/*"]
  end

  subgraph Data["Supabase PostgreSQL"]
    UsersTable["users"]
    SessionsTable["chat_sessions"]
    MessagesTable["chat_messages"]
    BriefsTable["briefs"]
    AnnotationsTable["content_annotations"]
    PromptsTable["prompt_templates"]
    VersionsTable["prompt_versions"]
    WordpressTable["wordpress_settings"]
    GscCredentials["gsc_credentials"]
    GscPageMetrics["gsc_page_metrics"]
    GscQueryMetrics["gsc_query_metrics"]
    GscEvaluations["gsc_article_evaluations"]
    GscHistory["gsc_article_evaluation_history"]
  end

  subgraph External["External Services"]
    LINE["LINE Platform (LIFF / Verify)"]
    Anthropic["Anthropic Claude"]
    OpenAI["OpenAI GPT-4.1 nano FT"]
    Stripe["Stripe Subscriptions"]
    WordPress["WordPress REST API"]
    GSC["Google Search Console API"]
  end

  LIFFProvider --> AuthMiddleware
  ChatUI --> ChatStream
  Canvas --> CanvasStream
  Annotation --> ServerActions
  Analytics --> WordPressAPI
  BusinessForm --> ServerActions
  AdminUI --> ServerActions
  GscSetup --> GscAPI
  GscDashboard --> GscAPI

  ServerActions --> UsersTable
  ServerActions --> BriefsTable
  ServerActions --> AnnotationsTable
  ChatStream --> MessagesTable
  ChatStream --> SessionsTable
  WordPressAPI --> WordpressTable
  AdminAPI --> PromptsTable
  AdminAPI --> VersionsTable
  GscAPI --> GscCredentials
  GscAPI --> GscPageMetrics
  GscAPI --> GscQueryMetrics
  GscAPI --> GscEvaluations
  GscCron --> GscEvaluations
  GscCron --> GscHistory

  AuthMiddleware --> LINE
  ChatStream --> Anthropic
  CanvasStream --> Anthropic
  ChatStream --> OpenAI
  SubscriptionAPI --> Stripe
  WordPressAPI --> WordPress
  GscAPI --> GSC
  GscCron --> GSC
```

## ğŸ”„ èªè¨¼ãƒ•ãƒ­ãƒ¼

### 1. LINE LIFF èªè¨¼ãƒ•ãƒ­ãƒ¼ï¼ˆåŸºæœ¬èªè¨¼ï¼‰

**å¯¾è±¡**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼
**ç›®çš„**: ã‚¢ãƒ—ãƒªã¸ã®åŸºæœ¬èªè¨¼
**ä¿å­˜å…ˆ**: `users` ãƒ†ãƒ¼ãƒ–ãƒ«

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client (LIFF)
    participant L as LINE Platform
    participant S as Next.js Server
    participant DB as Supabase

    U->>C: ã‚¢ãƒ—ãƒªã¸ã‚¢ã‚¯ã‚»ã‚¹
    C->>L: LIFF åˆæœŸåŒ–
    alt æœªãƒ­ã‚°ã‚¤ãƒ³
        C->>L: LINE Login ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
        L->>U: èªè¨¼ç”»é¢ã‚’è¡¨ç¤º
        U->>L: èªè¨¼è¨±å¯
        L->>C: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ä»˜ä¸
    end
    C->>S: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
    S->>L: Verify API ç…§ä¼š
    L->>S: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¿”å´
    S->>DB: users ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ upsert / last_login_at æ›´æ–°
    opt ç®¡ç†è€… or ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç¢ºèª
        S->>DB: role / subscription state ã‚’å‚ç…§
    end
    S->>C: èªè¨¼æ¸ˆã¿ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’è¿”å´
```

### 2. WordPress OAuth èªè¨¼ãƒ•ãƒ­ãƒ¼

**å¯¾è±¡**: ç®¡ç†è€…ã®ã¿
**ç›®çš„**: WordPress.com ã‚µã‚¤ãƒˆã¨ã®é€£æºï¼ˆæŠ•ç¨¿å–å¾—ãƒ»åŒæœŸï¼‰
**ä¿å­˜å…ˆ**: `wordpress_settings` ãƒ†ãƒ¼ãƒ–ãƒ«
**å¿…è¦ãªç’°å¢ƒå¤‰æ•°**: `WORDPRESS_COM_CLIENT_ID`, `WORDPRESS_COM_CLIENT_SECRET`, `WORDPRESS_COM_REDIRECT_URI`, `COOKIE_SECRET`

```mermaid
sequenceDiagram
    participant U as User (Admin)
    participant C as Client
    participant S as Next.js Server
    participant WP as WordPress.com OAuth
    participant DB as Supabase

    U->>C: WordPressé€£æºã‚’é–‹å§‹
    C->>S: /api/wordpress/oauth/start
    S->>S: LINEèªè¨¼ãƒã‚§ãƒƒã‚¯ & ç®¡ç†è€…æ¨©é™ç¢ºèª
    S->>S: OAuth state ç”Ÿæˆãƒ»Cookieä¿å­˜
    S->>WP: OAuthèªè¨¼URLã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    WP->>U: WordPress.comèªè¨¼ç”»é¢è¡¨ç¤º
    U->>WP: èªè¨¼è¨±å¯
    WP->>S: /api/wordpress/oauth/callback?code=xxx&state=yyy
    S->>S: stateæ¤œè¨¼
    S->>WP: ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ (code â†’ access_token)
    WP->>S: access_token, refresh_token è¿”å´
    S->>DB: wordpress_settings ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
    S->>C: é€£æºå®Œäº†ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
```

### 3. Google Search Console OAuth èªè¨¼ãƒ•ãƒ­ãƒ¼

**å¯¾è±¡**: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼
**ç›®çš„**: Google Search Console ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ãƒ»è¨˜äº‹è©•ä¾¡
**ä¿å­˜å…ˆ**: `gsc_credentials` ãƒ†ãƒ¼ãƒ–ãƒ«
**å¿…è¦ãªç’°å¢ƒå¤‰æ•°**: `GOOGLE_OAUTH_CLIENT_ID`, `GOOGLE_OAUTH_CLIENT_SECRET`, `GOOGLE_SEARCH_CONSOLE_REDIRECT_URI`, `COOKIE_SECRET`

```mermaid
sequenceDiagram
    participant U as User
    participant C as Client
    participant S as Next.js Server
    participant G as Google OAuth
    participant GSC as Google Search Console API
    participant DB as Supabase

    U->>C: GSCé€£æºã‚’é–‹å§‹
    C->>S: /api/gsc/oauth/start
    S->>S: LINEèªè¨¼ãƒã‚§ãƒƒã‚¯
    S->>S: OAuth state ç”Ÿæˆãƒ»Cookieä¿å­˜
    S->>G: OAuthèªè¨¼URLã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ<br/>(scope: webmasters.readonly)
    G->>U: Googleèªè¨¼ç”»é¢è¡¨ç¤º
    U->>G: èªè¨¼è¨±å¯
    G->>S: /api/gsc/oauth/callback?code=xxx&state=yyy
    S->>S: stateæ¤œè¨¼
    S->>G: ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ (code â†’ tokens)
    G->>S: access_token, refresh_token, scope è¿”å´
    S->>DB: gsc_credentials ã«ãƒˆãƒ¼ã‚¯ãƒ³ã‚’ä¿å­˜
    S->>C: é€£æºå®Œäº†ã‚’ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ

    Note over U,DB: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é¸æŠãƒ•ã‚§ãƒ¼ã‚º
    U->>C: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é¸æŠç”»é¢
    C->>S: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§å–å¾—
    S->>GSC: Sites.list API å‘¼ã³å‡ºã—
    GSC->>S: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§ã‚’è¿”å´
    S->>C: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§ã‚’è¡¨ç¤º
    U->>C: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’é¸æŠ
    C->>S: é¸æŠã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ä¿å­˜
    S->>DB: gsc_credentials ã® property_uri ã‚’æ›´æ–°
    S->>C: è¨­å®šå®Œäº†
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰**: Next.js 15.5.7 (App Router), React 19.2.1, TypeScript 5.9.3, Tailwind CSS v4, Radix UI, shadcn/ui, lucide-react
- **ã‚¨ãƒ‡ã‚£ã‚¿**: TipTap 3.7.x + lowlight ãƒã‚¤ãƒ©ã‚¤ãƒˆã€ã‚«ã‚¹ã‚¿ãƒ  UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç¾¤
- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰**: Next.js Route Handlers & Server Actions, Supabase JS 2.75 (PostgreSQL + RLS)
- **AI**: Anthropic Claude Sonnet 4.5ï¼ˆSSE ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ï¼‰, OpenAI Chat Completionsï¼ˆFine-tuned ãƒ¢ãƒ‡ãƒ«å«ã‚€ï¼‰
- **èªè¨¼**: LINE LIFF v2.25.1, WordPress.com OAuth 2.0, Google OAuth 2.0 (Search Console), Vercel Edge Cookie ã‚¹ãƒˆã‚¢, ç‹¬è‡ªãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã«ã‚ˆã‚‹ãƒ­ãƒ¼ãƒ«åˆ¤å®š
- **æ±ºæ¸ˆ**: Stripe 17.7ï¼ˆCheckout / Billing Portal / Subscription APIï¼‰
- **é–‹ç™ºãƒ„ãƒ¼ãƒ«**: TypeScript strict, ESLint 9, Prettier 3, tsc-watch, Husky, ngrok

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒï¼ˆä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰

```mermaid
erDiagram
    users {
        uuid id PK
        text line_user_id UK
        text line_display_name
        text line_picture_url
        text line_status_message
        text full_name
        text role
        text stripe_customer_id
        text stripe_subscription_id
        bigint last_login_at
        bigint created_at
        bigint updated_at
    }

    chat_sessions {
        text id PK
        text user_id FK
        text title
        text system_prompt
        bigint last_message_at
        bigint created_at
    }

    chat_messages {
        text id PK
        text user_id FK
        text session_id FK
        text role
        text content
        text model
        bigint created_at
    }

    briefs {
        uuid id PK
        text user_id UK
        jsonb data
        bigint created_at
        bigint updated_at
    }

    content_annotations {
        uuid id PK
        text user_id FK
        bigint wp_post_id
        text session_id
        text canonical_url
        text wp_post_title
        text wp_excerpt
        text wp_content_text
        text wp_categories
        text main_kw
        text kw
        text impressions
        text persona
        text needs
        text goal
        text prep
        text basic_structure
        text opening_proposal
        timestamptz created_at
        timestamptz updated_at
    }

    wordpress_settings {
        uuid id PK
        uuid user_id UK,FK
        text wp_type
        text wp_client_id
        text wp_client_secret
        text wp_site_id
        text wp_site_url
        text wp_username
        text wp_application_password
        text wp_access_token
        text wp_refresh_token
        timestamptz wp_token_expires_at
        text[] wp_content_types
        timestamptz created_at
        timestamptz updated_at
    }

    prompt_templates {
        uuid id PK
        text name
        text description
        text category
        boolean is_active
        uuid created_by FK
        timestamptz created_at
        timestamptz updated_at
    }

    prompt_versions {
        uuid id PK
        uuid template_id FK
        integer version_number
        text content
        text change_summary
        uuid created_by FK
        timestamptz created_at
    }

    gsc_credentials {
        uuid id PK
        uuid user_id UK,FK
        text google_account_email
        text refresh_token
        text access_token
        timestamptz access_token_expires_at
        text[] scope
        text property_uri
        text property_type
        text property_display_name
        text permission_level
        boolean verified
        timestamptz last_synced_at
        timestamptz created_at
        timestamptz updated_at
    }

    gsc_page_metrics {
        uuid id PK
        uuid user_id FK
        uuid content_annotation_id FK
        text property_uri
        text search_type
        date date
        text url
        text normalized_url
        integer clicks
        integer impressions
        numeric ctr
        numeric position
        timestamptz imported_at
    }

    gsc_query_metrics {
        uuid id PK
        uuid user_id FK
        text property_uri
        text property_type
        text search_type
        date date
        text url
        text normalized_url
        text query
        text query_normalized
        integer clicks
        integer impressions
        numeric ctr
        numeric position
        uuid content_annotation_id FK
        timestamptz imported_at
        timestamptz created_at
        timestamptz updated_at
    }

    gsc_article_evaluations {
        uuid id PK
        uuid user_id FK
        uuid content_annotation_id FK
        text property_uri
        smallint current_suggestion_stage
        date last_evaluated_on
        date base_evaluation_date
        integer cycle_days
        integer evaluation_hour
        numeric last_seen_position
        text status
        timestamptz created_at
        timestamptz updated_at
    }

    gsc_article_evaluation_history {
        uuid id PK
        uuid user_id FK
        uuid content_annotation_id FK
        date evaluation_date
        smallint stage
        numeric previous_position
        numeric current_position
        text outcome_type
        text outcome
        text error_code
        text error_message
        boolean suggestion_applied
        text suggestion_summary
        boolean is_read
        timestamptz created_at
    }

    users ||--o{ chat_sessions : owns
    chat_sessions ||--o{ chat_messages : contains
    users ||--|| briefs : "stores one brief"
    users ||--o{ content_annotations : annotates
    users ||--o| wordpress_settings : configures
    users ||--o| gsc_credentials : "has GSC auth"
    users ||--o{ gsc_page_metrics : owns
    users ||--o{ gsc_query_metrics : owns
    users ||--o{ gsc_article_evaluation_history : owns
    users ||--o{ prompt_templates : creates
    users ||--o{ prompt_versions : creates
    prompt_templates ||--o{ prompt_versions : "has versions"
    content_annotations ||--o| gsc_article_evaluations : "monitored by"
    content_annotations ||--o{ gsc_page_metrics : "tracked by"
    content_annotations ||--o{ gsc_query_metrics : "tracked by"
    content_annotations ||--o{ gsc_article_evaluation_history : "evaluated in"
    gsc_article_evaluations ||--o{ gsc_article_evaluation_history : "has history"
```

## ğŸ“‹ ç’°å¢ƒå¤‰æ•°ï¼ˆ18 é …ç›®: å¿…é ˆ14é …ç›®ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³4é …ç›®ï¼‰

`src/env.ts` ã§å³æ ¼ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã•ã‚Œã‚‹ã‚µãƒ¼ãƒãƒ¼ï¼ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç’°å¢ƒå¤‰æ•°ã§ã™ã€‚`.env.local` ã‚’æ‰‹å‹•ã§ç”¨æ„ã—ã¦ãã ã•ã„ã€‚

| ç¨®åˆ¥ | å¤‰æ•°å | å¿…é ˆ | ç”¨é€” |
| ---- | ------ | ---- | ---- |
| Server | `DBPASS` | âœ… | Supabase ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ Postgres password |
| Server | `SUPABASE_SERVICE_ROLE` | âœ… | ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ç‰¹æ¨©æ“ä½œç”¨ Service Role ã‚­ãƒ¼ |
| Server | `STRIPE_ENABLED` | ä»»æ„ | Stripe æ©Ÿèƒ½ã®æœ‰åŠ¹åŒ–ãƒ•ãƒ©ã‚°ï¼ˆ`true` / `false`ï¼‰ |
| Server | `STRIPE_SECRET_KEY` | âœ…ï¼ˆStripe ç„¡åŠ¹ã§ã‚‚ãƒ€ãƒŸãƒ¼å€¤å¿…é ˆï¼‰ | Stripe API å‘¼ã³å‡ºã—ç”¨ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ |
| Server | `STRIPE_PRICE_ID` | âœ…ï¼ˆStripe ç„¡åŠ¹ã§ã‚‚ãƒ€ãƒŸãƒ¼å€¤å¿…é ˆï¼‰ | ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã™ã‚‹ Price ID |
| Server | `OPENAI_API_KEY` | âœ… | Fine-tuned ãƒ¢ãƒ‡ãƒ«åˆ©ç”¨æ™‚ã® OpenAI ã‚­ãƒ¼ |
| Server | `ANTHROPIC_API_KEY` | âœ… | Claude ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ç”¨ API ã‚­ãƒ¼ |
| Server | `LINE_CHANNEL_ID` | âœ… | LINE Login ç”¨ãƒãƒ£ãƒãƒ« ID |
| Server | `LINE_CHANNEL_SECRET` | âœ… | LINE Login ç”¨ãƒãƒ£ãƒãƒ«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ |
| Server | `GOOGLE_OAUTH_CLIENT_ID` | ä»»æ„ï¼ˆGSC é€£æºåˆ©ç”¨æ™‚ã¯å¿…é ˆï¼‰ | Google Search Console OAuth ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ ID |
| Server | `GOOGLE_OAUTH_CLIENT_SECRET` | ä»»æ„ï¼ˆGSC é€£æºåˆ©ç”¨æ™‚ã¯å¿…é ˆï¼‰ | Google Search Console OAuth ç”¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ |
| Server | `GOOGLE_SEARCH_CONSOLE_REDIRECT_URI` | ä»»æ„ï¼ˆGSC é€£æºåˆ©ç”¨æ™‚ã¯å¿…é ˆï¼‰ | Google OAuth ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆï¼ˆ`https://<host>/api/gsc/oauth/callback` ãªã©ï¼‰ |
| Server | `GSC_OAUTH_STATE_COOKIE_NAME` | ä»»æ„ | GSC OAuth state ç”¨ Cookie åï¼ˆæœªè¨­å®šæ™‚ã¯ `gsc_oauth_state`ï¼‰ |
| Client | `NEXT_PUBLIC_LIFF_ID` | âœ… | LIFF ã‚¢ãƒ—ãƒª ID |
| Client | `NEXT_PUBLIC_LIFF_CHANNEL_ID` | âœ… | LIFF Channel ID |
| Client | `NEXT_PUBLIC_SUPABASE_URL` | âœ… | Supabase ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ URL |
| Client | `NEXT_PUBLIC_SUPABASE_ANON_KEY` | âœ… | Supabase anon ã‚­ãƒ¼ |
| Client | `NEXT_PUBLIC_SITE_URL` | âœ… | ã‚µã‚¤ãƒˆã®å…¬é–‹ URL |
| Client | `NEXT_PUBLIC_STRIPE_ENABLED` | ä»»æ„ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã® Stripe æœ‰åŠ¹åŒ–ãƒ•ãƒ©ã‚°ï¼ˆæœªè¨­å®šæ™‚ã¯ `STRIPE_ENABLED` ã‚’ç¶™æ‰¿ï¼‰ |

### è¿½åŠ ã§åˆ©ç”¨ã§ãã‚‹ä»»æ„è¨­å®š
- `WORDPRESS_COM_CLIENT_ID`, `WORDPRESS_COM_CLIENT_SECRET`, `WORDPRESS_COM_REDIRECT_URI`: WordPress.com OAuth é€£æºã§å¿…é ˆ
- `OAUTH_STATE_COOKIE_NAME`, `OAUTH_TOKEN_COOKIE_NAME`, `COOKIE_SECRET`: WordPress / Google Search Console OAuth ã®ã‚»ã‚­ãƒ¥ã‚¢ãª Cookie ç®¡ç†
- `GOOGLE_OAUTH_CLIENT_ID`, `GOOGLE_OAUTH_CLIENT_SECRET`, `GOOGLE_SEARCH_CONSOLE_REDIRECT_URI`: Google Search Console é€£æºã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã®ã¿è¨­å®š
- `GSC_EVALUATION_INTERVAL_DAYS`: GSCè¨˜äº‹è©•ä¾¡ã®å®Ÿè¡Œé–“éš”ï¼ˆæ—¥æ•°ï¼‰ã€‚æœªè¨­å®šæ™‚ã¯30æ—¥ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
- `FEATURE_RPC_V2`: `true` ã§æ–°ã—ã„ Supabase RPC çµŒè·¯ã‚’æœ‰åŠ¹åŒ–ï¼ˆ`FEATURE_FLAGS.USE_RPC_V2`ï¼‰

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### å¿…è¦æ¡ä»¶
- **Node.js**: 18 ä»¥ä¸Šï¼ˆæ¨å¥¨: 20.x LTSï¼‰
- **npm**: 9 ä»¥ä¸Š
- **Supabase æ¥ç¶šæƒ…å ±**ï¼ˆç®¡ç†è€…ã‹ã‚‰å–å¾—ï¼‰
- **LINE æ¥ç¶šæƒ…å ±**ï¼ˆç®¡ç†è€…ã‹ã‚‰å–å¾—ï¼‰
- **Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼ˆã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³åˆ©ç”¨æ™‚ï¼‰
- **ngrok ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼ˆLIFF ãƒ­ãƒ¼ã‚«ãƒ«ãƒ†ã‚¹ãƒˆç”¨ã€ä»»æ„ï¼‰

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³ã¨ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd industry-specific-mc-training

# ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install
```

### 2. Supabase ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

#### 2.1 æ—¢å­˜ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ¥ç¶šæƒ…å ±ã‚’å–å¾—

**é‡è¦**: ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æœ¬ç•ªç’°å¢ƒã¨é–‹ç™ºç’°å¢ƒã§Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å…±æœ‰ã—ã¦ã„ã¾ã™ã€‚æ–°è¦ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…ã‹ã‚‰ä»¥ä¸‹ã®æ¥ç¶šæƒ…å ±ã‚’å–å¾—ã—ã¦ãã ã•ã„ï¼š
   - **Project URL** (`https://xxxxx.supabase.co`)
   - **anon public key**
   - **service_role key**ï¼ˆç§˜å¯†æƒ…å ±ã€ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å°‚ç”¨ï¼‰
   - **Database Password**

2. ã“ã‚Œã‚‰ã®æƒ…å ±ã‚’ `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šã—ã¾ã™ï¼ˆè©³ç´°ã¯ã€Œ5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã€ã‚’å‚ç…§ï¼‰

#### 2.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã«ã¤ã„ã¦

- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ—¢ã«æœ¬ç•ªç’°å¢ƒã«é©ç”¨æ¸ˆã¿ã§ã™
- ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯ã€æ—¢å­˜ã®ã‚¹ã‚­ãƒ¼ãƒã‚’ãã®ã¾ã¾ä½¿ç”¨ã—ã¾ã™
- **ãƒ­ãƒ¼ã‚«ãƒ«ã§ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨ã¯ä¸è¦ã§ã™**ï¼ˆ`npx supabase db push` ã¯å®Ÿè¡Œã—ãªã„ã§ãã ã•ã„ï¼‰

**æ³¨æ„äº‹é …:**
- æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã¨åŒã˜ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿æ“ä½œã«ã¯ååˆ†æ³¨æ„ã—ã¦ãã ã•ã„
- ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ãƒ¼ã‚¿ä½œæˆæ™‚ã¯ã€è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã«ç´ä»˜ã‘ã¦ä½œæˆã—ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª¤ã£ã¦å¤‰æ›´ãƒ»å‰Šé™¤ã—ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„
- ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€å¿…ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„

### 3. LINE ã®è¨­å®š

**é‡è¦**: ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯æœ¬ç•ªç’°å¢ƒã¨é–‹ç™ºç’°å¢ƒã§LINE Login ChannelãŠã‚ˆã³LIFFã‚¢ãƒ—ãƒªã‚’å…±æœ‰ã—ã¦ã„ã¾ã™ã€‚æ–°è¦ã«ä½œæˆã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

#### 3.1 æ—¢å­˜ã®LINEæ¥ç¶šæƒ…å ±ã‚’å–å¾—

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…ã‹ã‚‰ä»¥ä¸‹ã®æ¥ç¶šæƒ…å ±ã‚’å–å¾—ã—ã¦ãã ã•ã„ï¼š

- **LINE Channel ID**: LINE Login ãƒãƒ£ãƒãƒ«ã®ãƒãƒ£ãƒãƒ« ID
- **LINE Channel Secret**: LINE Login ãƒãƒ£ãƒãƒ«ã®ãƒãƒ£ãƒãƒ«ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ
- **LIFF ID**: æ—¢å­˜ã®LIFFã‚¢ãƒ—ãƒªã®IDï¼ˆ`<liff-id>` å½¢å¼ï¼‰

ã“ã‚Œã‚‰ã®æƒ…å ±ã‚’ `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨­å®šã—ã¾ã™ï¼ˆè©³ç´°ã¯ã€Œ5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®šã€ã‚’å‚ç…§ï¼‰ã€‚

#### 3.2 LINEè¨­å®šã®æ³¨æ„äº‹é …

**æ³¨æ„äº‹é …:**
- æœ¬ç•ªç’°å¢ƒã¨åŒã˜LINE ChannelãŠã‚ˆã³LIFFã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã—ã¾ã™
- **LINE Developers Consoleã§ã®è¨­å®šå¤‰æ›´ã¯æœ¬ç•ªç’°å¢ƒã«ã‚‚å½±éŸ¿ã—ã¾ã™**
- LIFF ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ URL ã‚„ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ URL ã®å¤‰æ›´ã¯è¡Œã‚ãªã„ã§ãã ã•ã„
- è¨­å®šå¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ã€å¿…ãšãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„

### 4. Stripe ã®è¨­å®šï¼ˆã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰

#### 4.1 Stripe ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆã¨ã‚­ãƒ¼å–å¾—
1. [Stripe Dashboard](https://dashboard.stripe.com/) ã«ãƒ­ã‚°ã‚¤ãƒ³
2. ã€Œé–‹ç™ºè€…ã€â†’ã€ŒAPI ã‚­ãƒ¼ã€ã‹ã‚‰ä»¥ä¸‹ã‚’å–å¾—ï¼š
   - **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚­ãƒ¼**ï¼ˆ`sk_test_...` ã¾ãŸã¯ `sk_live_...`ï¼‰

#### 4.2 ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å•†å“ã¨ Price ID ã®ä½œæˆ
1. Stripe Dashboard ã®ã€Œå•†å“ã€â†’ã€Œå•†å“ã‚’è¿½åŠ ã€
2. ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å•†å“ã‚’ä½œæˆã—ã€**Price ID** (`price_xxxxx`) ã‚’ã‚³ãƒ”ãƒ¼

#### 4.3 Stripe ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å ´åˆ
- `STRIPE_ENABLED=false` ã‚’è¨­å®š
- ãŸã ã—ã€`STRIPE_SECRET_KEY` ã¨ `STRIPE_PRICE_ID` ã«ã¯ãƒ€ãƒŸãƒ¼å€¤ï¼ˆä¾‹: `sk_test_dummy`ï¼‰ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

### 5. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.env.local` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä»¥ä¸‹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã—ã¦ãã ã•ã„ï¼š

```bash
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Supabase è¨­å®š
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
DBPASS=your_supabase_database_password
SUPABASE_SERVICE_ROLE=your_supabase_service_role_key
NEXT_PUBLIC_SUPABASE_URL=https://xxxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# LINE è¨­å®š
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
LINE_CHANNEL_ID=your_line_channel_id
LINE_CHANNEL_SECRET=your_line_channel_secret
NEXT_PUBLIC_LIFF_ID=your_liff_id
NEXT_PUBLIC_LIFF_CHANNEL_ID=your_line_channel_id

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Stripe è¨­å®š
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
STRIPE_ENABLED=true  # Stripe ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹å ´åˆã¯ false
STRIPE_SECRET_KEY=sk_test_xxxxx
STRIPE_PRICE_ID=price_xxxxx
NEXT_PUBLIC_STRIPE_ENABLED=true  # çœç•¥æ™‚ã¯ STRIPE_ENABLED ã‚’ç¶™æ‰¿

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# AI API ã‚­ãƒ¼
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ANTHROPIC_API_KEY=sk-ant-xxxxx
OPENAI_API_KEY=sk-proj-xxxxx

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ã‚µã‚¤ãƒˆ URL
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
NEXT_PUBLIC_SITE_URL=https://your-ngrok-url.ngrok.io  # ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºæ™‚
# NEXT_PUBLIC_SITE_URL=https://your-domain.com  # æœ¬ç•ªç’°å¢ƒ

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# WordPress.com OAuth è¨­å®šï¼ˆä»»æ„ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
WORDPRESS_COM_CLIENT_ID=your_wordpress_com_client_id
WORDPRESS_COM_CLIENT_SECRET=your_wordpress_com_client_secret
WORDPRESS_COM_REDIRECT_URI=https://your-ngrok-url.ngrok.io/api/wordpress/oauth/callback
COOKIE_SECRET=your_random_32_char_secret_key  # openssl rand -hex 32 ã§ç”Ÿæˆ
OAUTH_STATE_COOKIE_NAME=wp_oauth_state
OAUTH_TOKEN_COOKIE_NAME=wp_oauth_token

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# æ©Ÿèƒ½ãƒ•ãƒ©ã‚°ï¼ˆä»»æ„ï¼‰
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
FEATURE_RPC_V2=false  # æ–°ã—ã„ Supabase RPC ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹å ´åˆã¯ true
```

**é‡è¦**: `.env.local` ã¯ `.gitignore` ã«å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯ Vercel ã®ç’°å¢ƒå¤‰æ•°è¨­å®šã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

### 6. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
# TypeScript ã®å‹ãƒã‚§ãƒƒã‚¯ + Next.js é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ `http://localhost:3000` ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### 7. LIFF ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®ãŸã‚ã® ngrok ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆä»»æ„ï¼‰

LIFF ã¯HTTPSç’°å¢ƒãŒå¿…é ˆã®ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§LIFFæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆã¯ ngrok ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

**é‡è¦**: æœ¬ç•ªç’°å¢ƒã¨LINEè¨­å®šã‚’å…±æœ‰ã—ã¦ã„ã‚‹ãŸã‚ã€é€šå¸¸ã®ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ã¯ngrokã¯ä¸è¦ã§ã™ã€‚LIFFèªè¨¼ãŒå¿…è¦ãªæ©Ÿèƒ½ã‚’é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆã™ã‚‹å ´åˆã®ã¿ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

#### 7.1 ngrok ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
1. [ngrok](https://ngrok.com/) ã«ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—
2. ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§ã¯å›ºå®šã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒä½¿ãˆãªã„ãŸã‚ã€æœ‰æ–™ãƒ—ãƒ©ãƒ³ã¾ãŸã¯èµ·å‹•æ¯ã®å‹•çš„ URL ã‚’ä½¿ç”¨
3. `package.json` ã® ngrok ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç’°å¢ƒã«åˆã‚ã›ã¦èª¿æ•´ï¼š
   ```json
   "ngrok": "ngrok http --region=jp --subdomain=your-subdomain 3000"
   ```

#### 7.2 ngrok ã®èµ·å‹•ã¨ãƒ†ã‚¹ãƒˆç”¨è¨­å®š

```bash
# åˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ ngrok ã‚’èµ·å‹•
npm run ngrok
```

ngrok ãŒè¡¨ç¤ºã™ã‚‹ HTTPS URLï¼ˆä¾‹: `https://your-subdomain.ngrok.io`ï¼‰ã‚’ `.env.local` ã® `NEXT_PUBLIC_SITE_URL` ã«ä¸€æ™‚çš„ã«è¨­å®šã§ãã¾ã™ã€‚

**æ³¨æ„**:
- LINE Developers Console ã® LIFF ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ URL ã‚„ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ URL ã¯**æœ¬ç•ªè¨­å®šã®ã¾ã¾å¤‰æ›´ã—ãªã„ã§ãã ã•ã„**
- ngrok URL ã§ã®å®Œå…¨ãªLIFFå‹•ä½œç¢ºèªã¯ã€æœ¬ç•ªè¨­å®šã¨ã®ç«¶åˆãŒç™ºç”Ÿã™ã‚‹ãŸã‚æ¨å¥¨ã•ã‚Œã¾ã›ã‚“
- LIFFä»¥å¤–ã®APIæ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã«ã¯ã€ngrokãªã—ã§ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆï¼ˆhttp://localhost:3000ï¼‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„

### 8. å‹•ä½œç¢ºèªã¨æ¤œè¨¼

#### 8.1 Lint ãƒã‚§ãƒƒã‚¯
```bash
npm run lint
```

#### 8.2 ãƒ“ãƒ«ãƒ‰ãƒã‚§ãƒƒã‚¯
```bash
npm run build
npm run start
```

#### 8.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆç¢ºèª
```bash
npm run db:stats
```

#### 8.4 Vercel çµ±è¨ˆç¢ºèªï¼ˆVercel ã«ãƒ‡ãƒ—ãƒ­ã‚¤æ¸ˆã¿ã®å ´åˆï¼‰
```bash
npm run vercel:stats
```

### 9. åˆæœŸãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆå›ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸå¾Œã€ä»¥ä¸‹ã®è¨­å®šã‚’è¡Œã„ã¾ã™ï¼š

1. **ç®¡ç†è€…ãƒ­ãƒ¼ãƒ«ã®ä»˜ä¸**: Supabase ã® `users` ãƒ†ãƒ¼ãƒ–ãƒ«ã§è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® `role` ã‚’ `admin` ã«å¤‰æ›´
2. **äº‹æ¥­è€…æƒ…å ±ã®ç™»éŒ²**: `/business-info` ã§ 5W2H ãªã©ã®åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›
3. **WordPress é€£æº**ï¼ˆä»»æ„ï¼‰: `/setup/wordpress` ã§ WordPress ã‚µã‚¤ãƒˆã‚’æ¥ç¶š
4. **ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®ç¢ºèª**: `/admin/prompts` ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç¢ºèªãƒ»ç·¨é›†

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®ãƒã‚¤ãƒ³ãƒˆ
- `npm run lint` ã§ ESLint + Next/Tailwind ãƒ«ãƒ¼ãƒ«ã‚’æ¤œè¨¼ï¼ˆHusky pre-commit ã§ã‚‚è‡ªå‹•å®Ÿè¡Œï¼‰
- `npm run build` â†’ `npm run start` ã§æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã®å¥å…¨æ€§ã‚’ãƒã‚§ãƒƒã‚¯
- **Supabase ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´**: æœ¬ç•ªç’°å¢ƒã¨å…±æœ‰ã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´ã¯å¿…ãšç®¡ç†è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„ã€‚å¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯ `supabase/migrations/` ã« SQL ã‚’è¿½åŠ ã—ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«æ®‹ã—ã¾ã™
- **ãƒ‡ãƒ¼ã‚¿æ“ä½œã®æ³¨æ„**: æœ¬ç•ªãƒ‡ãƒ¼ã‚¿ã¨åŒã˜DBã‚’ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯è‡ªåˆ†ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã«ç´ä»˜ã‘ã¦ä½œæˆã—ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’èª¤ã£ã¦å¤‰æ›´ãƒ»å‰Šé™¤ã—ãªã„ã‚ˆã†æ³¨æ„ã—ã¦ãã ã•ã„
- **LINEè¨­å®šã®æ³¨æ„**: æœ¬ç•ªç’°å¢ƒã¨LINE ChannelãŠã‚ˆã³LIFFã‚¢ãƒ—ãƒªã‚’å…±æœ‰ã—ã¦ã„ã‚‹ãŸã‚ã€LINE Developers Consoleã§ã®è¨­å®šå¤‰æ›´ã¯çµ¶å¯¾ã«è¡Œã‚ãªã„ã§ãã ã•ã„ã€‚è¨­å®šå¤‰æ›´ãŒå¿…è¦ãªå ´åˆã¯å¿…ãšç®¡ç†è€…ã«ç›¸è«‡ã—ã¦ãã ã•ã„
- LIFF æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã¯æœ¬ç•ªç’°å¢ƒã§å®Ÿæ–½ã™ã‚‹ã‹ã€ç®¡ç†è€…ã®æŒ‡ç¤ºã«å¾“ã£ã¦ãã ã•ã„
- TypeScript strict ãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ãªãŸã‚ã€å‹ã‚¨ãƒ©ãƒ¼ã‚’è§£æ±ºã—ã¦ã‹ã‚‰ commit ã™ã‚‹
- ã‚³ãƒŸãƒƒãƒˆå‰ã« Husky ãŒè‡ªå‹•ã§ lint ã‚’å®Ÿè¡Œã—ã¾ã™ï¼ˆå¤±æ•—æ™‚ã¯ commit ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ï¼‰

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ chat/                # AI ãƒãƒ£ãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ï¼ˆCanvas / Annotation / Step UIï¼‰
â”‚   â”œâ”€â”€ analytics/           # WordPress æŠ•ç¨¿ + æ³¨é‡ˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ business-info/       # äº‹æ¥­è€…æƒ…å ±ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆServer Components + Actionsï¼‰
â”‚   â”œâ”€â”€ setup/               # WordPress / GSC ç­‰ã®åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å°ç·š
â”‚   â”œâ”€â”€ subscription/        # ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³è³¼å…¥ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ login/               # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ home/                # ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ï¼ˆéèªè¨¼å¯ï¼‰
â”‚   â”œâ”€â”€ privacy/             # ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ï¼ˆéèªè¨¼å¯ï¼‰
â”‚   â”œâ”€â”€ unauthorized/        # æœªèªå¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ unavailable/         # åˆ©ç”¨ä¸å¯ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒšãƒ¼ã‚¸ï¼ˆrole ãŒ unavailable ã®å ´åˆï¼‰
â”‚   â”œâ”€â”€ wordpress-import/    # WordPress è¨˜äº‹ã®ä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ gsc-dashboard/       # GSC ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ gsc-import/          # GSC ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ admin/               # ç®¡ç†è€…å‘ã‘æ©Ÿèƒ½ï¼ˆãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ api/                 # Route Handlersï¼ˆchat, wordpress, admin, auth, user, line, gsc, cronï¼‰
â”‚   â””â”€â”€ layout.tsx ãªã©      # App Router ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/          # å†åˆ©ç”¨å¯èƒ½ãª UIï¼ˆshadcn/ui, AnnotationFormFields ç­‰ï¼‰
â”‚   â”œâ”€â”€ domain/              # ãƒ•ãƒ­ãƒ³ãƒˆå‘ã‘ã‚µãƒ¼ãƒ“ã‚¹å±¤ï¼ˆChatService / SubscriptionServiceï¼‰
â”‚   â”œâ”€â”€ hooks/               # LIFF / ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ / UI ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”œâ”€â”€ lib/                 # å®šæ•°ãƒ»ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç®¡ç†ãƒ»Supabase ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
â”‚   â”œâ”€â”€ server/
â”‚   â”‚   â”œâ”€â”€ actions/         # Server Actions çµŒç”±ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ middleware/      # èªè¨¼ãƒ»ãƒ­ãƒ¼ãƒ«åˆ¤å®šãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”‚   â”œâ”€â”€ services/        # çµ±åˆå±¤ï¼ˆStripe / WordPress / Supabase / LLM / GSC ãªã©ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ chatService.ts            # ãƒãƒ£ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ gscService.ts             # GSC åŸºæœ¬æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ gscEvaluationService.ts   # GSC è¨˜äº‹è©•ä¾¡å‡¦ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ gscSuggestionService.ts   # GSC æ”¹å–„ææ¡ˆç”Ÿæˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ gscImportService.ts       # GSC ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ analyticsContentService.ts # ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å‡¦ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ chatLimitService.ts       # ãƒãƒ£ãƒƒãƒˆåˆ¶é™ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ ... ãã®ä»–ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”‚   â”œâ”€â”€ schemas/         # Zod ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒ
â”‚   â”‚   â””â”€â”€ lib/             # ã‚µãƒ¼ãƒãƒ¼å°‚ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â””â”€â”€ types/               # å…±é€šå‹å®šç¾©ï¼ˆchat, prompt, annotation, wordpress ç­‰ï¼‰
â”œâ”€â”€ scripts/                 # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆDB çµ±è¨ˆãƒ»Vercel çµ±è¨ˆï¼‰
â”œâ”€â”€ claudedocs/              # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆ
â”œâ”€â”€ supabase/migrations/     # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â””â”€â”€ config files             # eslint.config.mjs, next.config.ts, tailwind/postcss è¨­å®š
```

## ğŸ”§ ä¸»ãª API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

| ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¡ã‚½ãƒƒãƒ‰ | æ¦‚è¦ | èªè¨¼ |
| -------------- | -------- | ---- | ---- |
| `/api/chat/anthropic/stream` | POST | Claude ã¨ã®ãƒãƒ£ãƒƒãƒˆ SSE ã‚¹ãƒˆãƒªãƒ¼ãƒ  | `Authorization: Bearer <LIFF>` |
| `/api/chat/canvas/stream` | POST | Canvas ç·¨é›†ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆé¸æŠç¯„å›²å·®ã—æ›¿ãˆï¼‰ | `Authorization: Bearer <LIFF>` |
| `/api/chat/canvas/load-wordpress` | POST | WordPressè¨˜äº‹ã‚’Canvasã«èª­ã¿è¾¼ã¿ | `Authorization: Bearer <LIFF>` |
| `/api/refresh` | POST | LINE ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å†ç™ºè¡Œ | Cookie (`line_refresh_token`) |
| `/api/user/current` | GET | ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ­ãƒ¼ãƒ«æƒ…å ± | Cookie (`line_access_token`) |
| `/api/auth/check-role` | GET | ãƒ­ãƒ¼ãƒ«ã®ã‚µãƒ¼ãƒãƒ¼æ¤œè¨¼ | Cookie |
| `/api/auth/clear-cache` | POST | Edge ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢é€šçŸ¥ | ä»»æ„ |
| `/api/auth/line-oauth-init` | GET | LINE OAuth stateç”Ÿæˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | Cookie |
| `/api/line/callback` | GET | LINE OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ | å…¬é–‹ï¼ˆstate ãƒã‚§ãƒƒã‚¯ã‚ã‚Šï¼‰ |
| `/api/wordpress/settings` | GET/POST | WordPress è¨­å®šã®å–å¾—ãƒ»ä¿å­˜ï¼ˆserver action ã¨å…±æœ‰ï¼‰ | Cookie |
| `/api/wordpress/status` | GET | WordPress æ¥ç¶šçŠ¶æ³ã®ç¢ºèª | Cookie |
| `/api/wordpress/posts` | GET | WordPress æŠ•ç¨¿ä¸€è¦§ã®å–å¾— | Cookie + WP èªè¨¼ |
| `/api/wordpress/test-connection` | POST | WordPress æ¥ç¶šãƒ†ã‚¹ãƒˆ | Cookie |
| `/api/wordpress/oauth/start` | GET | WordPress.com OAuth ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆé–‹å§‹ | å…¬é–‹ï¼ˆç’°å¢ƒå¤‰æ•°å¿…é ˆï¼‰ |
| `/api/wordpress/oauth/callback` | GET | WordPress.com OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ | Cookie |
| `/api/admin/prompts` | GET | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ï¼ˆç®¡ç†è€…å°‚ç”¨ï¼‰ | Cookie + admin ãƒ­ãƒ¼ãƒ« |
| `/api/admin/prompts/[id]` | POST | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ›´æ–°ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç”Ÿæˆ | Cookie + admin ãƒ­ãƒ¼ãƒ« |
| `/api/wordpress/bulk-import-posts` | POST | WordPress è¨˜äº‹ã®ä¸€æ‹¬ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | Bearer + admin ãƒ­ãƒ¼ãƒ« |
| `/api/gsc/status` | GET | GSCé€£æºçŠ¶æ…‹ç¢ºèª | Cookie |
| `/api/gsc/oauth/start` | GET | GSC OAuth ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆé–‹å§‹ | å…¬é–‹ï¼ˆç’°å¢ƒå¤‰æ•°å¿…é ˆï¼‰ |
| `/api/gsc/oauth/callback` | GET | GSC OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ | Cookie |
| `/api/gsc/disconnect` | POST | GSCé€£æºè§£é™¤ | Cookie |
| `/api/gsc/properties` | GET | GSCãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ä¸€è¦§å–å¾— | Cookie |
| `/api/gsc/property` | POST | GSCãƒ—ãƒ­ãƒ‘ãƒ†ã‚£é¸æŠ | Cookie |
| `/api/gsc/dashboard` | GET | GSCãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿å–å¾— | Cookie |
| `/api/gsc/import` | POST | GSCãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ | Cookie |
| `/api/gsc/evaluate` | POST | GSCè¨˜äº‹è©•ä¾¡ã®æ‰‹å‹•å®Ÿè¡Œ | Cookie |
| `/api/gsc/evaluations` | GET | GSCè©•ä¾¡å±¥æ­´å–å¾— | Cookie |
| `/api/cron/gsc-evaluate` | POST | GSCè¨˜äº‹è©•ä¾¡ã®å®šæœŸå®Ÿè¡Œï¼ˆGitHub Actions ãªã©ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©çµŒç”±ã§ Bearer èªè¨¼ï¼‰ | Authorization ãƒ˜ãƒƒãƒ€ãƒ¼ |

### GSC è©•ä¾¡ãƒãƒƒãƒï¼ˆGitHub Actions ã§ã®å®Ÿè¡Œä¾‹ï¼‰
- Vercel ç’°å¢ƒå¤‰æ•°: `CRON_SECRET` ã‚’è¨­å®šï¼ˆCronãƒãƒƒãƒç”¨ã®å…±æœ‰ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆï¼‰
- GitHub Actions Secret: åŒã˜å€¤ã® `CRON_SECRET` ã‚’ç™»éŒ²
- ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: `.github/workflows/gsc-cron.yml` ã® `TARGET_URL` ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç½®ãæ›ãˆã‚‹ï¼ˆä¾‹: `https://your-app.vercel.app/api/cron/gsc-evaluate`ï¼‰
- èªè¨¼: GitHub Actions ã‹ã‚‰ `Authorization: Bearer <CRON_SECRET>` ãƒ˜ãƒƒãƒ€ãƒ¼ä»˜ãã§å‘¼ã³å‡ºã—
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ¯æ™‚0åˆ†ï¼ˆ`0 * * * *`ï¼‰ã€`workflow_dispatch` ã§æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

ã‚µãƒ¼ãƒãƒ¼ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ (`src/server/actions/*`) ã§ã¯ã€ãƒ–ãƒªãƒ¼ãƒ•ä¿å­˜ãƒ»WordPress æŠ•ç¨¿å–å¾—ãƒ»æ³¨é‡ˆ upsertãƒ»Stripe ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆãªã©ã‚’å‹å®‰å…¨ã«å‡¦ç†ã—ã¦ã„ã¾ã™ã€‚

## ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨é‹ç”¨ã®æ³¨æ„ç‚¹
- Supabase ã§ã¯ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«ã« RLS ã‚’é©ç”¨æ¸ˆã¿ï¼ˆé–‹ç™ºãƒãƒªã‚·ãƒ¼ãŒæ®‹ã‚‹ç®‡æ‰€ã¯é‹ç”¨å‰ã«è¦‹ç›´ã™ï¼‰
- `authMiddleware` ãŒãƒ­ãƒ¼ãƒ«ãƒ»ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¤œè¨¼ã—ã€`requiresSubscription` ã§ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã‚’ä¿è­·
- WordPress ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚„ OAuth ãƒˆãƒ¼ã‚¯ãƒ³ã¯ HTTP-only Cookie ã«ä¿å­˜ï¼ˆæœ¬ç•ªã§ã¯å®‰å…¨ãª KMS / Secrets ç®¡ç†ã‚’æ¨å¥¨ï¼‰
- SSE ã¯ 20 ç§’ã”ã¨ã® ping ã¨ 5 åˆ†ã‚¢ã‚¤ãƒ‰ãƒ«ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§æ¥ç¶šç¶­æŒã‚’èª¿æ•´
- `AnnotationPanel` ã® URL æ­£è¦åŒ–ã§å†…éƒ¨ï¼ãƒ­ãƒ¼ã‚«ãƒ«ãƒ›ã‚¹ãƒˆã¸ã®èª¤ç™»éŒ²ã‚’é˜²æ­¢

## ğŸ“± ãƒ‡ãƒ—ãƒ­ã‚¤ã¨é‹ç”¨
- Vercel ã‚’æƒ³å®šï¼ˆEdge Runtime ã¨ Node.js Runtime ã‚’ãƒ«ãƒ¼ãƒˆã”ã¨ã«åˆ‡ã‚Šåˆ†ã‘ï¼‰
- ãƒ‡ãƒ—ãƒ­ã‚¤å‰ãƒã‚§ãƒƒã‚¯: `npm run lint` â†’ `npm run build`
- ç’°å¢ƒå¤‰æ•°ã¯ Vercel Project Settings ã¸åæ˜ ã—ã€æœ¬ç•ªã¯ Stripe æœ¬ç•ªã‚­ãƒ¼ãƒ»WordPress æœ¬ç•ªã‚µã‚¤ãƒˆã«åˆ‡ã‚Šæ›¿ãˆ
- Supabase ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ `npx supabase db push` ã§åŒæœŸã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆï¼‰ã‚’å¸¸ã«æ›´æ–°

### GitHub Actions ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆè¨­å®š
é€±æ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§ä½¿ç”¨ã™ã‚‹ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã‚’ GitHub Repository Settings â†’ Secrets and variables â†’ Actions ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚

| ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆå | ç”¨é€” | å¿…é ˆ |
| ------------- | ---- | ---- |
| `CI_WEBHOOK_URL` | CI ãƒ“ãƒ«ãƒ‰çµæœé€šçŸ¥ç”¨ Lark Webhook URL | ä»»æ„ |
| `DB_STATS_WEBHOOK_URL` | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆç”¨ Lark Webhook URL | ä»»æ„ |
| `VERCEL_STATS_WEBHOOK_URL` | Vercel çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆç”¨ Lark Webhook URL | ä»»æ„ |
| `VERCEL_TOKEN` | Vercel API ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆSettings â†’ Tokens ã§ä½œæˆï¼‰ | Vercel ãƒ¬ãƒãƒ¼ãƒˆç”¨ |
| `VERCEL_PROJECT_ID` | Vercel ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ IDï¼ˆ`prj_` ã§å§‹ã¾ã‚‹ï¼‰ | Vercel ãƒ¬ãƒãƒ¼ãƒˆç”¨ |
| `VERCEL_TEAM_ID` | Vercel ãƒãƒ¼ãƒ  IDï¼ˆ`team_` ã§å§‹ã¾ã‚‹ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ | Vercel ãƒ¬ãƒãƒ¼ãƒˆç”¨ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |

**Vercel API ãƒˆãƒ¼ã‚¯ãƒ³ã®å–å¾—æ–¹æ³•:**
1. Vercel Dashboard â†’ Settings â†’ Tokens
2. ã€ŒCreate Tokenã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒˆãƒ¼ã‚¯ãƒ³åã‚’å…¥åŠ›ã—ã€ã‚¹ã‚³ãƒ¼ãƒ—ã‚’è¨­å®šï¼ˆ`Full Account` ã¾ãŸã¯ `Project` ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰
4. ç”Ÿæˆã•ã‚ŒãŸãƒˆãƒ¼ã‚¯ãƒ³ã‚’ `VERCEL_TOKEN` ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã«è¨­å®š

**Vercel ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ ID ã®å–å¾—æ–¹æ³•:**
- Vercel Dashboard â†’ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â†’ Settings â†’ General ã®ã€ŒProject IDã€ã‚’ç¢ºèª
- ã¾ãŸã¯ã€`.vercel/project.json` ãƒ•ã‚¡ã‚¤ãƒ«ã® `projectId` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç¢ºèª

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³
1. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
2. å¤‰æ›´ã‚’å®Ÿè£…ã—ã€`npm run lint` ã®çµæœã‚’ç¢ºèª
3. å¿…è¦ã«å¿œã˜ã¦ Supabase ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã€ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ã‚’æ˜è¨˜
4. å¤‰æ›´å†…å®¹ã‚’ç°¡æ½”ã«ã¾ã¨ã‚ãŸ PR ã‚’ä½œæˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å½±éŸ¿ãƒ»ç’°å¢ƒå¤‰æ•°ãƒ»ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã‚’æ·»ä»˜ï¼‰

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ç§çš„åˆ©ç”¨ç›®çš„ã§é‹ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚å†é…å¸ƒã‚„å•†ç”¨åˆ©ç”¨ã¯äº‹å‰ç›¸è«‡ã®ã†ãˆã§ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚
