<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600" viewBox="0 0 800 600">
  <style>
    .title { font: bold 24px sans-serif; fill: #333; }
    .layer-title { font: bold 18px sans-serif; fill: #333; }
    .layer-desc { font: 14px sans-serif; fill: #333; }
    .layer-box { stroke: #333; stroke-width: 2; }
    .arrow { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    .file-path { font: italic 12px sans-serif; fill: #666; }
    .example { font: 12px sans-serif; fill: #333; }
  </style>
  
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="400" y="40" text-anchor="middle" class="title">LIFF-Template アーキテクチャ</text>
  
  <!-- Client Layer -->
  <rect x="100" y="80" width="600" height="70" rx="5" class="layer-box" fill="#61DAFB" opacity="0.7" />
  <text x="400" y="110" text-anchor="middle" class="layer-title">クライアント層（Presentation Layer）</text>
  <text x="400" y="135" text-anchor="middle" class="layer-desc">Reactコンポーネント - ユーザーインターフェースとインタラクション</text>
  <text x="150" y="145" class="file-path">/src/app/, /src/components/</text>
  <text x="650" y="145" text-anchor="end" class="example">例: ChatPage, LiffProvider</text>
  
  <!-- Hooks Layer -->
  <rect x="120" y="170" width="560" height="70" rx="5" class="layer-box" fill="#38BDF8" opacity="0.7" />
  <text x="400" y="200" text-anchor="middle" class="layer-title">フック層（Hooks Layer）</text>
  <text x="400" y="225" text-anchor="middle" class="layer-desc">Reactカスタムフック - UIとサービス層の橋渡し役</text>
  <text x="170" y="235" class="file-path">/src/hooks/</text>
  <text x="630" y="235" text-anchor="end" class="example">例: useLiff, useSubscription</text>
  
  <!-- Server Actions Layer -->
  <rect x="140" y="260" width="520" height="70" rx="5" class="layer-box" fill="#0EA5E9" opacity="0.7" />
  <text x="400" y="290" text-anchor="middle" class="layer-title">サーバーアクション層（Server Actions Layer）</text>
  <text x="400" y="315" text-anchor="middle" class="layer-desc">Next.js Server Actions - クライアントからサーバーへのリクエスト処理</text>
  <text x="190" y="325" class="file-path">/src/server/handler/actions/</text>
  <text x="610" y="325" text-anchor="end" class="example">例: chat.actions.ts</text>
  
  <!-- Service Layer -->
  <rect x="160" y="350" width="480" height="70" rx="5" class="layer-box" fill="#0284C7" opacity="0.7" />
  <text x="400" y="380" text-anchor="middle" class="layer-title">サービス層（Service Layer）</text>
  <text x="400" y="405" text-anchor="middle" class="layer-desc">ビジネスロジック - 複数のリポジトリやAPIの連携</text>
  <text x="210" y="415" class="file-path">/src/server/services/</text>
  <text x="590" y="415" text-anchor="end" class="example">例: chatService, userService</text>
  
  <!-- Repository Layer -->
  <rect x="180" y="440" width="440" height="70" rx="5" class="layer-box" fill="#0369A1" opacity="0.7" />
  <text x="400" y="470" text-anchor="middle" class="layer-title">リポジトリ層（Repository Layer）</text>
  <text x="400" y="495" text-anchor="middle" class="layer-desc">データアクセス - データベースとのやり取りを抽象化</text>
  <text x="230" y="505" class="file-path">/src/server/services/内のリポジトリクラス</text>
  <text x="570" y="505" text-anchor="end" class="example">例: chatRepository</text>
  
  <!-- External Services Layer -->
  <rect x="200" y="530" width="400" height="70" rx="5" class="layer-box" fill="#075985" opacity="0.7" />
  <text x="400" y="560" text-anchor="middle" class="layer-title" fill="#fff">外部サービス抽象層（External Services Layer）</text>
  <text x="400" y="585" text-anchor="middle" class="layer-desc" fill="#fff">外部APIとの統合 - 外部依存を抽象化</text>
  <text x="250" y="595" class="file-path" fill="#fff">/src/server/services/内の特定のサービスクラス</text>
  <text x="550" y="595" class="file-path" fill="#fff">例: supabaseService</text>
  
  <!-- Arrows -->
  <path d="M400,150 L400,170" class="arrow" />
  <path d="M400,240 L400,260" class="arrow" />
  <path d="M400,330 L400,350" class="arrow" />
  <path d="M400,420 L400,440" class="arrow" />
  <path d="M400,510 L400,530" class="arrow" />
</svg>
